(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{432:function(t,s,a){"use strict";a.r(s);var r=a(27),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"node-js版本管理与环境配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node-js版本管理与环境配置"}},[t._v("#")]),t._v(" Node.js版本管理与环境配置")]),t._v(" "),s("p",[t._v("在Node.js开发过程中，经常需要在不同项目间切换Node版本，或者需要配置国内镜像源来加速依赖下载。这里整理了一些实用的环境配置技巧。")]),t._v(" "),s("h2",{attrs:{id:"nvm版本管理工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nvm版本管理工具"}},[t._v("#")]),t._v(" NVM版本管理工具")]),t._v(" "),s("p",[t._v("NVM (Node Version Manager) 是Node.js的版本管理工具，可以方便地在多个Node版本之间切换。")]),t._v(" "),s("h3",{attrs:{id:"安装与配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装与配置"}},[t._v("#")]),t._v(" 安装与配置")]),t._v(" "),s("p",[t._v("如果遇到问题，建议下载最新版本重新安装：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/coreybutler/nvm-windows/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("NVM for Windows发布页"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"配置国内镜像源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置国内镜像源"}},[t._v("#")]),t._v(" 配置国内镜像源")]),t._v(" "),s("p",[t._v("修改配置文件 "),s("code",[t._v("C:\\Users\\Administrator\\AppData\\Roaming\\nvm\\settings.txt")]),t._v("，添加以下内容：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("node_mirror: https://npmmirror.com/mirrors/node/\nnpm_mirror: https://npmmirror.com/mirrors/npm/\n")])])]),s("h3",{attrs:{id:"常用命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),s("p",[s("strong",[t._v("查看已安装的版本：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("nvm list\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或查看所有可下载的版本")]),t._v("\nnvm list available\n")])])]),s("p",[s("strong",[t._v("安装指定版本：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("nvm "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.13")]),t._v(".0\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或安装最新稳定版")]),t._v("\nnvm "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" latest\n")])])]),s("p",[s("strong",[t._v("切换Node版本：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("nvm use "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.13")]),t._v(".0\n")])])]),s("p",[s("strong",[t._v("卸载版本：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("nvm uninstall "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.13")]),t._v(".0\n")])])]),s("h3",{attrs:{id:"其他实用命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他实用命令"}},[t._v("#")]),t._v(" 其他实用命令")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("nvm arch")]),t._v("：显示当前node运行在32位还是64位")]),t._v(" "),s("li",[s("code",[t._v("nvm on")]),t._v("：开启node版本管理")]),t._v(" "),s("li",[s("code",[t._v("nvm off")]),t._v("：关闭node版本管理")]),t._v(" "),s("li",[s("code",[t._v("nvm proxy [url]")]),t._v("：设置下载代理")]),t._v(" "),s("li",[s("code",[t._v("nvm root [path]")]),t._v("：设置node版本存储目录")]),t._v(" "),s("li",[s("code",[t._v("nvm version")]),t._v("：显示nvm版本")])]),t._v(" "),s("h2",{attrs:{id:"npm镜像源配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#npm镜像源配置"}},[t._v("#")]),t._v(" NPM镜像源配置")]),t._v(" "),s("h3",{attrs:{id:"设置淘宝镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置淘宝镜像"}},[t._v("#")]),t._v(" 设置淘宝镜像")]),t._v(" "),s("p",[t._v("NPM默认从国外服务器下载依赖，速度较慢。可以切换到国内镜像：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" registry https://registry.npmmirror.com\n")])])]),s("h3",{attrs:{id:"验证配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#验证配置"}},[t._v("#")]),t._v(" 验证配置")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config get registry\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" info express\n")])])]),s("h3",{attrs:{id:"恢复官方源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#恢复官方源"}},[t._v("#")]),t._v(" 恢复官方源")]),t._v(" "),s("p",[t._v("如需恢复到NPM官方源：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" registry https://registry.npmjs.org\n")])])]),s("h3",{attrs:{id:"重要提醒"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重要提醒"}},[t._v("#")]),t._v(" 重要提醒")]),t._v(" "),s("p",[t._v("淘宝NPM镜像已更新域名：")]),t._v(" "),s("ul",[s("li",[t._v("新域名："),s("code",[t._v("https://npmmirror.com")])]),t._v(" "),s("li",[t._v("新Registry："),s("code",[t._v("https://registry.npmmirror.com")])]),t._v(" "),s("li",[t._v("旧域名（已停用）："),s("code",[t._v("npm.taobao.org")]),t._v("、"),s("code",[t._v("registry.npm.taobao.org")])])]),t._v(" "),s("h2",{attrs:{id:"pm2进程管理配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pm2进程管理配置"}},[t._v("#")]),t._v(" PM2进程管理配置")]),t._v(" "),s("p",[t._v("PM2是Node.js应用的进程管理器，常用于生产环境部署。")]),t._v(" "),s("h3",{attrs:{id:"linux系统开机自启"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#linux系统开机自启"}},[t._v("#")]),t._v(" Linux系统开机自启")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("pm2 startup\npm2 save\n")])])]),s("p",[t._v("这会在"),s("code",[t._v("/etc/init.d/")]),t._v("目录生成启动脚本，并将当前运行的应用保存到"),s("code",[t._v("/root/.pm2/dump.pm2")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"日志管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#日志管理"}},[t._v("#")]),t._v(" 日志管理")]),t._v(" "),s("p",[t._v("PM2默认日志位置："),s("code",[t._v("C:\\Users\\Administrator\\.pm2\\logs")]),t._v("（Windows）")]),t._v(" "),s("p",[s("strong",[t._v("日志轮转配置（pm2-logrotate-ext）：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("pm2 "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" pm2-logrotate-ext\npm2 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" pm2-logrotate-ext:max_size 30M\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 每周轮转一次")]),t._v("\npm2 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" pm2-logrotate-ext:rotateInterval "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0 0 * * 1'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 每天轮转一次")]),t._v("\npm2 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" pm2-logrotate-ext:rotateInterval "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0 0 * * *'")]),t._v("\n")])])]),s("h3",{attrs:{id:"json配置文件示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#json配置文件示例"}},[t._v("#")]),t._v(" JSON配置文件示例")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"apps"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-app"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"script"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./app.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"log_date_format"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"YYYY-MM-DD HH:mm:ss:SS"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"log_file"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:/logs/app.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"error_file"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C:/logs/app_err.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"env"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"NODE_ENV"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"production"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"instances"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"exec_mode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cluster"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"watch"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"禁用默认日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#禁用默认日志"}},[t._v("#")]),t._v(" 禁用默认日志")]),t._v(" "),s("p",[t._v("如果不想在"),s("code",[t._v("~/.pm2/logs/")]),t._v("目录生成日志：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("apps")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-app"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("script")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/logs/my-app-error.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("output")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/logs/my-app-out.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("disable_logs")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关键配置")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"node-fetch使用注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node-fetch使用注意事项"}},[t._v("#")]),t._v(" Node-fetch使用注意事项")]),t._v(" "),s("p",[t._v("使用"),s("code",[t._v("node-fetch")]),t._v("发起HTTP请求时，需要注意：")]),t._v(" "),s("p",[t._v("默认情况下，headers会使用node-fetch的默认值：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("user-agent: 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)'")])])]),t._v(" "),s("p",[t._v("如需模拟真实浏览器请求，需要手动覆盖"),s("code",[t._v("Host")]),t._v("和"),s("code",[t._v("user-agent")]),t._v("等headers。")]),t._v(" "),s("h2",{attrs:{id:"create-react-app加速"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-react-app加速"}},[t._v("#")]),t._v(" Create React App加速")]),t._v(" "),s("p",[t._v("使用"),s("code",[t._v("create-react-app")]),t._v("创建项目时，如果下载速度慢，同样可以设置淘宝镜像：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" registry https://registry.npm.taobao.org\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 验证")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" config get registry\n")])])]),s("h2",{attrs:{id:"小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[t._v("#")]),t._v(" 小结")]),t._v(" "),s("p",[t._v("合理配置Node.js开发环境，可以显著提升开发效率：")]),t._v(" "),s("ul",[s("li",[t._v("使用NVM管理多个Node版本")]),t._v(" "),s("li",[t._v("配置国内镜像源加速依赖下载")]),t._v(" "),s("li",[t._v("使用PM2进行生产环境进程管理和日志管理")])]),t._v(" "),s("p",[t._v("这些配置一次设置，长期受益。")])])}),[],!1,null,null,null);s.default=e.exports}}]);