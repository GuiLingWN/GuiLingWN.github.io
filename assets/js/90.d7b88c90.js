(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{403:function(s,t,a){"use strict";a.r(t);var n=a(27),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"redis键值设置与过期时间管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis键值设置与过期时间管理"}},[s._v("#")]),s._v(" Redis键值设置与过期时间管理")]),s._v(" "),t("p",[s._v("Redis 是一个高性能的键值存储系统，支持多种数据结构。在使用 Redis 时，合理设置键值的过期时间对于内存管理和数据有效性非常重要。")]),s._v(" "),t("h2",{attrs:{id:"node-js-中设置-redis-键值及过期时间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node-js-中设置-redis-键值及过期时间"}},[s._v("#")]),s._v(" Node.js 中设置 Redis 键值及过期时间")]),s._v(" "),t("p",[s._v("在 Node.js 中使用 Redis 客户端时，可以通过以下方式同时设置键值和过期时间：")]),s._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使用回调方式设置键值并指定过期时间（秒）")]),s._v("\nclient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value!'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'EX'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使用 Promise 方式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value!'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'EX'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在实际项目中的应用示例")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" redisClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAsync")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stringify")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'EX'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("参数说明：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("'EX'")]),s._v("：设置键的过期时间，单位为秒")]),s._v(" "),t("li",[t("code",[s._v("'PX'")]),s._v("：设置键的过期时间，单位为毫秒")]),s._v(" "),t("li",[t("code",[s._v("'NX'")]),s._v("：只在键不存在时设置")]),s._v(" "),t("li",[t("code",[s._v("'XX'")]),s._v("：只在键存在时设置")])]),s._v(" "),t("h2",{attrs:{id:"其他设置过期时间的方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他设置过期时间的方法"}},[s._v("#")]),s._v(" 其他设置过期时间的方法")]),s._v(" "),t("p",[s._v("除了在设置键值时同时指定过期时间外，Redis 还提供了专门的命令来管理键的过期时间：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置键的过期时间（秒）")]),s._v("\nEXPIRE key "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置键的过期时间（毫秒）")]),s._v("\nPEXPIRE key "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置键在指定时间戳过期")]),s._v("\nEXPIREAT key timestamp\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看键的剩余生存时间（秒）")]),s._v("\nTTL key\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看键的剩余生存时间（毫秒）")]),s._v("\nPTTL key\n")])])]),t("h2",{attrs:{id:"过期策略"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#过期策略"}},[s._v("#")]),s._v(" 过期策略")]),s._v(" "),t("p",[s._v("Redis 采用惰性删除和定期删除相结合的策略来处理过期键：")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("惰性删除")]),s._v("：当访问一个键时，检查该键是否过期，如果过期则删除")]),s._v(" "),t("li",[t("strong",[s._v("定期删除")]),s._v("：每隔一段时间检查一部分键，删除其中过期的键")])]),s._v(" "),t("h2",{attrs:{id:"最佳实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[s._v("#")]),s._v(" 最佳实践")]),s._v(" "),t("ol",[t("li",[s._v("合理设置过期时间，避免内存浪费")]),s._v(" "),t("li",[s._v("对于临时数据，如验证码、会话信息等，务必设置过期时间")]),s._v(" "),t("li",[s._v("定期监控 Redis 内存使用情况，及时调整过期策略")]),s._v(" "),t("li",[s._v("在高并发场景下，注意过期键删除对性能的影响")])]),s._v(" "),t("p",[s._v("通过合理使用 Redis 的过期时间管理功能，可以有效提升系统性能和资源利用率。")])])}),[],!1,null,null,null);t.default=e.exports}}]);