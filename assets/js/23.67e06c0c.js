(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{337:function(a,s,t){"use strict";t.r(s);var e=t(27),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"docker基础与常用命令速查"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker基础与常用命令速查"}},[a._v("#")]),a._v(" Docker基础与常用命令速查")]),a._v(" "),s("p",[a._v("在日常使用Docker的过程中，总会遇到各种各样的操作需求。本文整理了一些常用的Docker命令和操作技巧，方便随时查阅参考。")]),a._v(" "),s("h2",{attrs:{id:"镜像与容器管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#镜像与容器管理"}},[a._v("#")]),a._v(" 镜像与容器管理")]),a._v(" "),s("h3",{attrs:{id:"构建与运行容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建与运行容器"}},[a._v("#")]),a._v(" 构建与运行容器")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 构建镜像")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("your username"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/node-web-app "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 删除镜像")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" rmi hello-world\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 运行镜像并映射端口")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("49160")]),a._v(":8080 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("your username"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/node-web-app\n")])])]),s("h3",{attrs:{id:"容器操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#容器操作"}},[a._v("#")]),a._v(" 容器操作")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("container id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /bin/bash\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 以root权限进入容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" root jenkins /bin/bash\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 删除容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("container id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看容器元数据")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" inspect "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("container_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看容器挂载的目录映射")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" inspect container_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" Mounts "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-A")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),a._v("\n")])])]),s("h3",{attrs:{id:"文件拷贝"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件拷贝"}},[a._v("#")]),a._v(" 文件拷贝")]),a._v(" "),s("p",[a._v("容器与本地文件系统之间的文件传输：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 从容器拷贝到本地")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("CONTAINER_ID"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(":容器目录 本地目录\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 示例")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" 52ea915e6527:/aha /home/aha2\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 从本地拷贝到容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" 本地路径 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("CONTAINER_ID"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(":容器目录\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 示例")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" license.dat 52ea915e6527:/home\n")])])]),s("h3",{attrs:{id:"修改容器配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改容器配置"}},[a._v("#")]),a._v(" 修改容器配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 修改容器启动参数（如设置自动重启）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" container update "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--restart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("always "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("container name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),s("p",[a._v("如需修改端口映射等配置，可以编辑容器配置文件：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("/var/lib/docker/containers/[hash_of_the_container]/hostconfig.json\n")])])]),s("p",[a._v("修改后需要重启Docker服务才能生效。")]),a._v(" "),s("h2",{attrs:{id:"镜像迁移与管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#镜像迁移与管理"}},[a._v("#")]),a._v(" 镜像迁移与管理")]),a._v(" "),s("h3",{attrs:{id:"镜像导入导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#镜像导入导出"}},[a._v("#")]),a._v(" 镜像导入导出")]),a._v(" "),s("p",[s("strong",[a._v("方法一：通过容器（export/import）")])]),a._v(" "),s("p",[a._v("适合制作基础镜像，体积更小但不包含历史信息：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看所有容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 导出容器为镜像文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("容器id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" image.tar\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 导入镜像并指定名称")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("import")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("容器名"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v(" image.tar\n")])])]),s("p",[s("strong",[a._v("方法二：通过镜像（save/load）")])]),a._v(" "),s("p",[a._v("保留完整的镜像历史和元数据，支持多镜像打包：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看所有镜像")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" images\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 导出单个镜像")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" save "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("镜像id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" image.tar\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 导出多个镜像到一个文件")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" save "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" image.tar 镜像1 镜像2\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 导入镜像")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" load "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v(" image.tar\n")])])]),s("p",[s("strong",[a._v("两种方式的主要区别：")])]),a._v(" "),s("ul",[s("li",[a._v("export导出的文件更小，但会丢失镜像历史记录")]),a._v(" "),s("li",[a._v("save保留完整的镜像层信息，可以回滚")]),a._v(" "),s("li",[a._v("import可以重命名镜像，load不能")]),a._v(" "),s("li",[a._v("save支持多镜像打包，export不支持")])]),a._v(" "),s("p",[s("strong",[a._v("实际应用场景：")])]),a._v(" "),s("ul",[s("li",[a._v("内网服务器部署：使用save打包所有依赖镜像，在内网load导入")]),a._v(" "),s("li",[a._v("制作基础镜像：使用export导出配置好的容器环境")])]),a._v(" "),s("h2",{attrs:{id:"网络配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#网络配置"}},[a._v("#")]),a._v(" 网络配置")]),a._v(" "),s("h3",{attrs:{id:"使用host网络模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用host网络模式"}},[a._v("#")]),a._v(" 使用host网络模式")]),a._v(" "),s("p",[a._v("使用"),s("code",[a._v("--net=host")]),a._v("参数可以让容器直接使用宿主机网络，无需端口映射：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--net")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("image_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),s("p",[s("strong",[a._v("优点：")])]),a._v(" "),s("ul",[s("li",[a._v("无需配置端口映射，容器内端口即主机端口")]),a._v(" "),s("li",[a._v("容器内显示主机hostname而不是容器ID")])]),a._v(" "),s("h2",{attrs:{id:"镜像加速配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#镜像加速配置"}},[a._v("#")]),a._v(" 镜像加速配置")]),a._v(" "),s("p",[a._v("在"),s("code",[a._v("/etc/docker/daemon.json")]),a._v("中配置镜像源（如文件不存在请新建）：")]),a._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"registry-mirrors"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://reg-mirror.qiniu.com/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("重启Docker服务：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl daemon-reload\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl restart "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n")])])]),s("p",[s("strong",[a._v("常用镜像源：")])]),a._v(" "),s("ul",[s("li",[a._v("科大镜像：https://docker.mirrors.ustc.edu.cn/")]),a._v(" "),s("li",[a._v("网易：https://hub-mirror.c.163.com/")]),a._v(" "),s("li",[a._v("七牛云：https://reg-mirror.qiniu.com")]),a._v(" "),s("li",[a._v("阿里云：https://<你的ID>.mirror.aliyuncs.com")])]),a._v(" "),s("h2",{attrs:{id:"安装docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[a._v("#")]),a._v(" 安装Docker")]),a._v(" "),s("p",[a._v("在Debian系统上，可以使用DaoCloud的一键安装脚本：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-sSL")]),a._v(" https://get.daocloud.io/docker "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v("\n")])])]),s("h2",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[a._v("#")]),a._v(" 参考资料")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.runoob.com/docker/docker-container-usage.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Docker官方容器使用文档"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://nodejs.org/zh-cn/docs/guides/nodejs-docker-webapp/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Node.js Docker应用教程"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);