(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{350:function(s,a,t){"use strict";t.r(a);var e=t(27),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"使用putty通过ssh密钥连接服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用putty通过ssh密钥连接服务器"}},[s._v("#")]),s._v(" 使用PuTTY通过SSH密钥连接服务器")]),s._v(" "),a("p",[s._v("SSH密钥认证是一种比密码更安全的服务器登录方式。本文记录了使用PuTTY工具通过SSH密钥连接远程服务器的配置过程。")]),s._v(" "),a("h2",{attrs:{id:"什么是ssh密钥认证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是ssh密钥认证"}},[s._v("#")]),s._v(" 什么是SSH密钥认证")]),s._v(" "),a("p",[s._v("SSH密钥认证使用一对密钥（公钥和私钥）来验证身份，相比密码认证有以下优势：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("更安全")]),s._v("：不会因为密码泄露或被暴力破解而导致服务器被攻击")]),s._v(" "),a("li",[a("strong",[s._v("更便捷")]),s._v("：配置完成后无需每次输入密码")]),s._v(" "),a("li",[a("strong",[s._v("可管理")]),s._v("：可以为不同的设备生成不同的密钥对")])]),s._v(" "),a("h2",{attrs:{id:"生成ssh密钥对"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生成ssh密钥对"}},[s._v("#")]),s._v(" 生成SSH密钥对")]),s._v(" "),a("h3",{attrs:{id:"使用puttygen生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用puttygen生成"}},[s._v("#")]),s._v(" 使用PuTTYgen生成")]),s._v(" "),a("ol",[a("li",[s._v("打开PuTTYgen工具")]),s._v(" "),a("li",[s._v("选择密钥类型（推荐RSA，密钥长度2048或4096位）")]),s._v(" "),a("li",[s._v('点击"Generate"按钮，随机移动鼠标生成密钥')]),s._v(" "),a("li",[s._v("设置密钥密码（Key passphrase），增加额外的安全层")]),s._v(" "),a("li",[s._v("保存私钥（Save private key）到本地安全位置")]),s._v(" "),a("li",[s._v("复制公钥内容（Public key for pasting...）")])]),s._v(" "),a("h3",{attrs:{id:"linux-mac系统生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-mac系统生成"}},[s._v("#")]),s._v(" Linux/Mac系统生成")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成RSA密钥对")]),s._v("\nssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"your_email@example.com"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看公钥内容")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ~/.ssh/id_rsa.pub\n")])])]),a("h2",{attrs:{id:"配置服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置服务器"}},[s._v("#")]),s._v(" 配置服务器")]),s._v(" "),a("h3",{attrs:{id:"添加公钥到服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加公钥到服务器"}},[s._v("#")]),s._v(" 添加公钥到服务器")]),s._v(" "),a("ol",[a("li",[s._v("登录到服务器")]),s._v(" "),a("li",[s._v("编辑authorized_keys文件："),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" ~/.ssh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" ~/.ssh/authorized_keys\n")])])])]),s._v(" "),a("li",[s._v("将公钥内容粘贴到文件中（每个公钥占一行）")]),s._v(" "),a("li",[s._v("设置正确的权限："),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("700")]),s._v(" ~/.ssh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" ~/.ssh/authorized_keys\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"配置ssh服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置ssh服务"}},[s._v("#")]),s._v(" 配置SSH服务")]),s._v(" "),a("p",[s._v("编辑SSH配置文件：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/ssh/sshd_config\n")])])]),a("p",[s._v("确认以下配置：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 启用公钥认证\nPubkeyAuthentication yes\n\n# 指定公钥文件位置\nAuthorizedKeysFile .ssh/authorized_keys\n\n# 可选：禁用密码登录（提高安全性）\nPasswordAuthentication no\n")])])]),a("p",[s._v("重启SSH服务：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Debian/Ubuntu")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart sshd\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CentOS/RHEL")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart sshd\n")])])]),a("h2",{attrs:{id:"使用putty连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用putty连接"}},[s._v("#")]),s._v(" 使用PuTTY连接")]),s._v(" "),a("h3",{attrs:{id:"配置session"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置session"}},[s._v("#")]),s._v(" 配置Session")]),s._v(" "),a("ol",[a("li",[s._v("打开PuTTY")]),s._v(" "),a("li",[s._v("在Session页面填写：\n"),a("ul",[a("li",[s._v("Host Name: 服务器IP地址或域名")]),s._v(" "),a("li",[s._v("Port: SSH端口（默认22）")]),s._v(" "),a("li",[s._v("Connection type: SSH")])])])]),s._v(" "),a("h3",{attrs:{id:"配置密钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置密钥"}},[s._v("#")]),s._v(" 配置密钥")]),s._v(" "),a("ol",[a("li",[s._v("展开Connection → SSH → Auth")]),s._v(" "),a("li",[s._v('点击"Browse"按钮选择私钥文件（.ppk格式）')]),s._v(" "),a("li",[s._v("返回Session页面，保存配置（Save）")])]),s._v(" "),a("h3",{attrs:{id:"连接服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#连接服务器"}},[s._v("#")]),s._v(" 连接服务器")]),s._v(" "),a("ol",[a("li",[s._v('双击保存的Session或点击"Open"')]),s._v(" "),a("li",[s._v('首次连接会提示确认服务器指纹，点击"是"')]),s._v(" "),a("li",[s._v("如果私钥设置了密码，输入密钥密码")]),s._v(" "),a("li",[s._v("成功登录服务器")])]),s._v(" "),a("h2",{attrs:{id:"安全建议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安全建议"}},[s._v("#")]),s._v(" 安全建议")]),s._v(" "),a("h3",{attrs:{id:"密钥管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#密钥管理"}},[s._v("#")]),s._v(" 密钥管理")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("私钥保护：")])]),s._v(" "),a("ul",[a("li",[s._v("私钥文件设置严格的访问权限")]),s._v(" "),a("li",[s._v("为私钥设置强密码")]),s._v(" "),a("li",[s._v("不要将私钥上传到云端或共享")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("公钥管理：")])]),s._v(" "),a("ul",[a("li",[s._v("定期审查authorized_keys文件")]),s._v(" "),a("li",[s._v("删除不再使用的公钥")]),s._v(" "),a("li",[s._v("为不同用途使用不同密钥对")])])])]),s._v(" "),a("h3",{attrs:{id:"ssh服务加固"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh服务加固"}},[s._v("#")]),s._v(" SSH服务加固")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("修改默认端口：")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("Port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2222")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 改为非标准端口")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("限制登录用户：")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("AllowUsers username1 username2\n")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("禁用root登录：")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("PermitRootLogin no\n")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("启用防火墙：")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只允许特定IP访问SSH端口")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ufw allow from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v(".3.4 to any port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"常见问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[s._v("#")]),s._v(" 常见问题")]),s._v(" "),a("h3",{attrs:{id:"权限错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#权限错误"}},[s._v("#")]),s._v(" 权限错误")]),s._v(" "),a("p",[s._v("如果连接失败，检查文件权限：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .ssh目录必须是700")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ld")]),s._v(" ~/.ssh\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# authorized_keys必须是600")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" ~/.ssh/authorized_keys\n")])])]),a("h3",{attrs:{id:"密钥格式转换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#密钥格式转换"}},[s._v("#")]),s._v(" 密钥格式转换")]),s._v(" "),a("p",[s._v("PuTTY使用.ppk格式，OpenSSH使用标准格式。")]),s._v(" "),a("p",[a("strong",[s._v("OpenSSH转PuTTY：")])]),s._v(" "),a("ol",[a("li",[s._v("使用PuTTYgen导入OpenSSH私钥")]),s._v(" "),a("li",[s._v("保存为.ppk格式")])]),s._v(" "),a("p",[a("strong",[s._v("PuTTY转OpenSSH：")])]),s._v(" "),a("ol",[a("li",[s._v("使用PuTTYgen加载.ppk文件")]),s._v(" "),a("li",[s._v("Conversions → Export OpenSSH key")])]),s._v(" "),a("h3",{attrs:{id:"连接超时"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#连接超时"}},[s._v("#")]),s._v(" 连接超时")]),s._v(" "),a("p",[s._v("检查网络和防火墙配置：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试端口连通性")]),s._v("\ntelnet server-ip "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看SSH服务状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl status sshd\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查防火墙规则")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ufw status\n")])])]),a("h2",{attrs:{id:"多密钥管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多密钥管理"}},[s._v("#")]),s._v(" 多密钥管理")]),s._v(" "),a("h3",{attrs:{id:"配置ssh-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置ssh-config"}},[s._v("#")]),s._v(" 配置SSH config")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("~/.ssh/config")]),s._v("中配置多个主机：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 生产服务器\nHost prod-server\n    HostName 1.2.3.4\n    User admin\n    Port 2222\n    IdentityFile ~/.ssh/prod_rsa\n\n# 开发服务器\nHost dev-server\n    HostName 5.6.7.8\n    User developer\n    Port 22\n    IdentityFile ~/.ssh/dev_rsa\n")])])]),a("p",[s._v("使用时直接：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" prod-server\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" dev-server\n")])])]),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.chiark.greenend.org.uk/~sgtatham/putty/docs.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("PuTTY官方文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.openssh.com/manual.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("OpenSSH官方文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Secure_Shell",target:"_blank",rel:"noopener noreferrer"}},[s._v("SSH密钥认证原理"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);