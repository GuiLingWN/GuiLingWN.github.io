(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{409:function(a,s,t){"use strict";t.r(s);var n=t(27),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"jenkins容器化部署与ssh乱码解决"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins容器化部署与ssh乱码解决"}},[a._v("#")]),a._v(" Jenkins容器化部署与SSH乱码解决")]),a._v(" "),s("p",[a._v("Jenkins是一款流行的持续集成工具，使用Docker部署Jenkins可以简化环境配置。本文记录了Jenkins容器化部署的步骤和SSH控制台乱码问题的解决方案。")]),a._v(" "),s("h2",{attrs:{id:"docker部署jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker部署jenkins"}},[a._v("#")]),a._v(" Docker部署Jenkins")]),a._v(" "),s("h3",{attrs:{id:"基本部署步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本部署步骤"}},[a._v("#")]),a._v(" 基本部署步骤")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 1. 创建Jenkins工作目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /data/jenkins_home/\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 2. 修改目录所有者，使Jenkins容器能够操作该目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#    UID 1000是Jenkins容器内的默认用户ID")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),a._v(":1000 /data/jenkins_home/\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 3. 运行Jenkins容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" jenkins "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v(":8080 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("50000")]),a._v(":50000 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /data/jenkins_home:/var/jenkins_home "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  jenkins/jenkins:jdk17\n")])])]),s("h3",{attrs:{id:"参数说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参数说明"}},[a._v("#")]),a._v(" 参数说明")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("-d")]),a._v("：后台运行容器")]),a._v(" "),s("li",[s("code",[a._v("--name jenkins")]),a._v("：指定容器名称")]),a._v(" "),s("li",[s("code",[a._v("-p 8080:8080")]),a._v("：映射Web访问端口")]),a._v(" "),s("li",[s("code",[a._v("-p 50000:50000")]),a._v("：映射Agent通信端口")]),a._v(" "),s("li",[s("code",[a._v("-v")]),a._v("：挂载数据卷，持久化Jenkins数据")]),a._v(" "),s("li",[s("code",[a._v("jenkins/jenkins:jdk17")]),a._v("：使用JDK17版本的Jenkins镜像")])]),a._v(" "),s("h3",{attrs:{id:"配置时区的部署方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置时区的部署方式"}},[a._v("#")]),a._v(" 配置时区的部署方式")]),a._v(" "),s("p",[a._v("如果需要设置容器时区为亚洲/上海时区：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /data/docker/jenkins_home/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),a._v(":1000 /data/docker/jenkins_home/\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" jenkins17 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8081")]),a._v(":8080 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("TZ")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Asia/Shanghai "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /data/docker/jenkins_home:/var/jenkins_home "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  jenkins/jenkins:jdk17\n")])])]),s("h3",{attrs:{id:"部署注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署注意事项"}},[a._v("#")]),a._v(" 部署注意事项")]),a._v(" "),s("ol",[s("li",[s("strong",[a._v("目录权限")]),a._v("：一定要设置正确的目录所有者（UID 1000），否则Jenkins无法写入数据")]),a._v(" "),s("li",[s("strong",[a._v("端口冲突")]),a._v("：确保8080和50000端口未被占用")]),a._v(" "),s("li",[s("strong",[a._v("数据持久化")]),a._v("：务必挂载数据卷，避免容器重启后数据丢失")]),a._v(" "),s("li",[s("strong",[a._v("初始密码")]),a._v("：首次访问需要查看初始管理员密码")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看初始密码")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" /data/jenkins_home/secrets/initialAdminPassword\n")])])]),s("h2",{attrs:{id:"jenkins-ssh控制台乱码问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-ssh控制台乱码问题"}},[a._v("#")]),a._v(" Jenkins SSH控制台乱码问题")]),a._v(" "),s("p",[a._v("在Jenkins执行SSH远程命令时，如果输出包含中文，可能会在控制台看到乱码。这是由于字符编码不一致导致的。")]),a._v(" "),s("h3",{attrs:{id:"问题现象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题现象"}},[a._v("#")]),a._v(" 问题现象")]),a._v(" "),s("p",[a._v("执行包含中文输出的脚本时，Jenkins控制台显示乱码字符。")]),a._v(" "),s("h3",{attrs:{id:"解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),s("p",[a._v("在Jenkins的SSH执行命令中，通过管道使用"),s("code",[a._v("iconv")]),a._v("命令转换字符编码：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" ./publish.sh "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("iconv")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" utf-8 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" gbk\n")])])]),s("h3",{attrs:{id:"参数说明-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参数说明-2"}},[a._v("#")]),a._v(" 参数说明")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("-f utf-8")]),a._v("：指定源编码为UTF-8")]),a._v(" "),s("li",[s("code",[a._v("-t gbk")]),a._v("：转换目标编码为GBK")]),a._v(" "),s("li",[s("code",[a._v("|")]),a._v("：管道符，将前一个命令的输出传递给后一个命令")])]),a._v(" "),s("h3",{attrs:{id:"其他编码转换场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他编码转换场景"}},[a._v("#")]),a._v(" 其他编码转换场景")]),a._v(" "),s("p",[a._v("根据实际情况，可能需要不同的编码转换：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# UTF-8转GBK")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("command")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("iconv")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" utf-8 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" gbk\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# GBK转UTF-8")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("command")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("iconv")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" gbk "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" utf-8\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看系统支持的编码")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("iconv")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--list")]),a._v("\n")])])]),s("h3",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[a._v("#")]),a._v(" 参考资料")]),a._v(" "),s("p",[a._v("更多关于Jenkins SSH乱码问题的讨论和解决方案，可以参考：\n"),s("a",{attrs:{href:"https://blog.csdn.net/chenxizhan1995/article/details/114528771",target:"_blank",rel:"noopener noreferrer"}},[a._v("Jenkins SSH中文乱码解决方案"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[a._v("#")]),a._v(" 小结")]),a._v(" "),s("p",[a._v("使用Docker部署Jenkins简化了环境配置，但需要注意目录权限和端口映射等细节。SSH控制台乱码问题虽然不影响功能，但会降低日志的可读性，通过简单的编码转换就能解决。在实际使用中，还需要根据项目需求配置构建环境、安装插件等，这些配置都会保存在挂载的数据卷中，方便迁移和备份。")])])}),[],!1,null,null,null);s.default=e.exports}}]);